{
  "rules": {
    "file_authorities": {
      "$file_id": {
        ".read": "data.child(auth.uid).exists()",
        ".write": "!data.exists() || data.child(auth.uid).exists()",

        "$uid": {
          "write": {
            ".validate": "newData.val() === true"
          },

          "$other": { ".validate": false }
        }
      }
    },
    "work_spaces": {
      "$uid": {
        ".read": "$uid === auth.uid",

        "files": {
          "$file_id": {
            ".write":
              "root.child('file_authorities/' + $file_id + '/' + $uid).exists()",
            ".validate": "newData.val() === true"
          }
        },

        "$other": { ".validate": false }
      }
    },
    "files": {
      "$file_id": {
        ".read":
          "root.child('file_authorities/' + $file_id + '/' + auth.uid).exists()",
        ".write":
          "root.child('file_authorities/' + $file_id + '/' + auth.uid + '/write').val() === true",

        "name": {
          ".validate": "newData.isString()"
        },
        "nodeCount": {
          ".validate": "newData.isNumber()"
        },
        "created": {
          ".validate": "newData.isNumber()"
        },
        "updated": {
          ".validate": "newData.isNumber()"
        },

        "$other": { ".validate": false }
      }
    },
    "nodes": {
      "$file_id": {
        ".read":
          "root.child('file_authorities/' + $file_id + '/' + auth.uid).exists()",
        ".write":
          "root.child('file_authorities/' + $file_id + '/' + auth.uid + '/write').val() === true",

        "text": {
          ".validate": "newData.isString()"
        },
        "children": {}
      }
    },

    "$other": { ".validate": false }
  }
}
